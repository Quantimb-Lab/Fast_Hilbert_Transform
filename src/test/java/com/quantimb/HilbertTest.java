package com.quantimb;

import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;

public class HilbertTest {

  private double[] signal1 = {1.   ,  0.702, -0.168, -1.023, -1.148, -0.311,  0.884,  1.373,
      0.596, -0.816, -1.471, -0.607,  0.939,  1.461,  0.303, -1.208,
      -1.219,  0.301,  1.374,  0.576, -0.957, -1.051,  0.363,  1.12 ,
      0.127, -0.955, -0.418,  0.723,  0.534, -0.526, -0.542,  0.397,
      0.499, -0.337, -0.438,  0.332,  0.372, -0.373, -0.292,  0.449,
      0.172, -0.541,  0.026,  0.593, -0.322, -0.502,  0.666,  0.152,
      -0.866,  0.454,  0.633, -1.021,  0.16 ,  0.984, -1.083, -0.023,
      1.18 , -1.191,  0.035,  1.193, -1.382,  0.397,  0.909, -1.499,
      0.979,  0.202, -1.196,  1.392, -0.759, -0.245,  1.033, -1.238,
      0.852, -0.146, -0.529,  0.912, -0.921,  0.63 , -0.196, -0.221,
      0.512, -0.635,  0.602, -0.459,  0.258, -0.046, -0.147,  0.304,
      -0.418,  0.49 , -0.524,  0.525, -0.497,  0.446, -0.377,  0.296,
      -0.207,  0.116, -0.028, -0.053,  0.123, -0.176,  0.21 , -0.219,
      0.201, -0.15 ,  0.063,  0.061, -0.224,  0.422, -0.646,  0.884,
      -1.115,  1.311, -1.442,  1.475, -1.384,  1.154, -0.791,  0.328,
      0.177, -0.641,  0.978, -1.112,  1.007, -0.681,  0.214,  0.268,
      -0.626,  0.755, -0.62 ,  0.281,  0.13 , -0.449,  0.548, -0.388,
      0.045,  0.314, -0.498,  0.387, -0.017, -0.402,  0.573, -0.315,
      -0.248,  0.686, -0.566, -0.122,  0.804, -0.758};

  /**
   * Tests using a signal with an even number of elements.
   */
  @Test
  public void testHilbert() {
    double[] result = {1.1989, 1.1646, 0.9854, 1.2155, 1.2632, 1.2619, 1.3624, 1.3877, 1.4103,
        1.4623, 1.4759, 1.4838, 1.5007, 1.5, 1.4901, 1.4781, 1.4527, 1.418, 1.3851, 1.3462, 1.2931,
        1.2382, 1.1861, 1.1246, 1.059, 1.0026, 0.9422, 0.8706, 0.8107, 0.7666, 0.7117, 0.6481,
        0.6086, 0.5892, 0.5551, 0.5122, 0.4989, 0.5134, 0.5152, 0.4998, 0.506, 0.5515, 0.5998,
        0.6217, 0.6364, 0.6873, 0.7724, 0.8448, 0.8804, 0.9095, 0.9753, 1.0734, 1.1601, 1.206,
        1.2227, 1.2531, 1.3229, 1.4084, 1.468, 1.4808, 1.4591, 1.4413, 1.457, 1.4992, 1.5359,
        1.5358, 1.4887, 1.4098, 1.3284, 1.272, 1.2506, 1.2492, 1.2421, 1.2089, 1.1412, 1.0411,
        0.9239, 0.8073, 0.7105, 0.6506, 0.6288, 0.6366, 0.6564, 0.6757, 0.6886, 0.6892, 0.6828,
        0.6647, 0.6416, 0.611, 0.5777, 0.5393, 0.4973, 0.4521, 0.4032, 0.3537, 0.3004, 0.2499,
        0.1999, 0.1657, 0.1525, 0.1763, 0.2291, 0.2971, 0.3801, 0.4681, 0.5672, 0.6678, 0.7801,
        0.8902, 1.0081, 1.1225, 1.2382, 1.3442, 1.4421, 1.5246, 1.5853, 1.6253, 1.6288, 1.6078,
        1.5419, 1.451, 1.3211, 1.1749, 1.0172, 0.8691, 0.7664, 0.7105, 0.7234, 0.7591, 0.7877,
        0.7976, 0.7501, 0.6779, 0.5609, 0.4438, 0.3872, 0.4046, 0.5023, 0.6052, 0.6396, 0.6517,
        0.5744, 0.4889, 0.548, 0.6863, 0.8547, 1.0855, 0.9561, 0.7818};

    final double[] hilbertTransform = Hilbert.computeHilbertTransform(signal1);
    final double[] amplitudeEnvelope = Hilbert.computeSignalEnvelope(hilbertTransform);
    Assertions.assertArrayEquals(result, amplitudeEnvelope, 0.001);
  }

  @Test
  public void testNullInputSignal() {
    boolean testFailed = true;
    try {
      Hilbert.computeHilbertTransform(null);
    } catch (NullPointerException e) {
      testFailed = false;
    }
    assert !testFailed;
  }

  @Test
  public void testNullEnvelope() {
    boolean testFailed = true;
    try {
      Hilbert.computeSignalEnvelope(null);
    } catch (NullPointerException e) {
      testFailed = false;
    }
    assert !testFailed;
  }

  /**
   * Tests using a signal with an odd number of elements
   */
  @Test
  public void testHilbertEnvelope2() {
    final double[] hilbertTransform = Hilbert.computeHilbertTransform(signal2);
    final double[] amplitudeEnvelope = Hilbert.computeSignalEnvelope(hilbertTransform);
    Assertions.assertArrayEquals(signal2EnvelopeExpected, amplitudeEnvelope, 0.001);
  }


  private double[] signal2 = {1.10194022e-01,  2.24547936e-01, -3.18759879e-01, -4.45762168e-01,
      4.63364096e-01,  4.90753705e-01,  3.18960334e-01, -2.54386747e-01,
      -4.28852134e-01, -5.49390391e-02, -3.22392534e-01,  2.12398298e-01,
      9.61334520e-02, -4.96433032e-01,  4.30028138e-01, -1.77551479e-01,
      3.50128935e-01,  4.55177255e-01, -1.06452125e-01, -7.40917936e-02,
      -3.43984205e-01, -3.84425418e-01, -1.80107101e-01, -4.45681478e-01,
      4.73731599e-01, -3.03372686e-01,  1.46988255e-01,  4.23311960e-01,
      -4.01235751e-01, -3.78825621e-01, -1.13716634e-01,  4.50954411e-01,
      2.96814851e-01, -1.10247803e-01,  8.95765847e-02, -1.05372195e-01,
      -4.81333873e-01, -2.53880186e-01,  6.19821866e-02,  4.86388211e-01,
      -3.35109308e-01, -4.62328214e-03,  1.43572958e-01,  3.33564602e-01,
      -4.64663750e-01,  1.63500346e-01, -2.66165634e-01, -1.64090796e-01,
      -1.05093727e-01,  3.13915702e-01,  1.14862281e-01, -3.16456688e-01,
      -4.82034155e-01,  4.99359559e-01,  7.27154879e-02,  1.43005510e-02,
      -7.53994895e-02, -1.52439959e-01,  4.50921623e-01, -1.66791764e-01,
      8.52418516e-02, -3.04047617e-03, -4.24411098e-01,  6.88469544e-02,
      2.53079802e-01, -7.85080833e-02,  2.85673688e-01,  4.47694136e-01,
      2.46564961e-01, -3.33705719e-01,  2.95040487e-01, -1.54606899e-01,
      -2.37967724e-01,  2.83013572e-01, -4.07026517e-03, -4.06847714e-01,
      -3.59915424e-01, -2.90941322e-01,  4.23085438e-01,  3.61881273e-01,
      7.99737922e-02, -1.52611870e-02, -4.69239494e-01,  1.41045140e-01,
      1.76103112e-01,  2.52850837e-01, -4.17056388e-01,  7.77711967e-02,
      1.88151026e-01, -2.03236245e-01,  3.40755547e-01, -1.12544087e-01,
      -1.07633934e-01,  4.20432454e-01, -3.30232711e-01,  1.55909334e-01,
      -3.57342901e-01,  1.69292325e-01,  7.20841140e-02, -3.58189595e-01,
      -3.17416843e-01,  4.60109218e-01,  1.99576221e-01, -1.81158444e-01,
      -4.70185163e-01,  3.62411173e-01, -1.55509502e-01,  2.70124143e-01,
      2.00902361e-02, -2.61007071e-01, -4.62516935e-01,  1.22485017e-01,
      1.60726557e-01,  2.57577231e-01,  4.05504361e-01, -4.74667311e-01,
      3.05378100e-01,  1.90856835e-01,  3.78377438e-01,  2.37524059e-01,
      -4.16435496e-01,  4.52170369e-01,  1.10469784e-01,  3.80957551e-01,
      1.11585670e-01,  4.69324044e-01, -1.79601292e-01,  3.91471618e-01,
      4.48609844e-01,  1.57151909e-01, -1.69651302e-01, -4.42006468e-01,
      -3.80572696e-01,  1.30120495e-01,  4.37756638e-01,  3.29027813e-01,
      -3.70142232e-01, -3.51591405e-01, -2.06682011e-01,  3.20904755e-01,
      -4.13336430e-01,  1.70713355e-01, -4.93483726e-01,  2.34298437e-01,
      1.64251724e-01, -4.52239074e-02, -2.44873134e-01,  4.11723898e-01,
      4.54774507e-01, -4.68086676e-01,  4.49109924e-01, -1.51553218e-01,
      -1.88339545e-01,  1.94384901e-01, -9.49646710e-02, -2.48966339e-01,
      -3.32783500e-02, -6.58366774e-02,  3.47580898e-01,  5.33339465e-02,
      -2.28210481e-01, -1.62014941e-01, -4.79915662e-01,  2.66080857e-01,
      -4.89221896e-01, -2.51640925e-01,  1.91584237e-01,  4.95425599e-01,
      -4.05552752e-01,  5.58185709e-02,  4.88547584e-02, -2.66513690e-01,
      3.61758606e-02, -2.89191236e-01, -1.64266948e-01, -2.72279158e-01,
      2.91471985e-01,  1.97987068e-01,  2.80160009e-01, -1.41735121e-01,
      4.51458131e-01, -2.21959474e-01,  3.05721577e-02, -2.68940170e-01,
      -8.18410177e-02,  2.48242553e-01, -3.98450505e-01,  4.01268997e-01,
      -1.70677961e-01,  2.39793749e-02, -4.93690384e-01,  2.73667609e-02,
      -2.02425906e-01, -1.41445740e-01,  3.64411432e-01, -3.03509646e-01,
      -3.31290966e-01,  4.31982230e-01,  2.19559739e-01,  3.72008213e-01,
      1.71613315e-01, -4.08542881e-01, -1.01492299e-01, -4.12598853e-01,
      -2.25456840e-01, -3.36449346e-01, -3.52528597e-03,  4.98262196e-01,
      -8.79797999e-02, -2.56023345e-01, -3.00092587e-02, -4.77989497e-01,
      -1.40855795e-01, -4.21433481e-01,  3.78656186e-01, -1.98106424e-01,
      4.81516680e-01,  3.62163376e-01, -4.30006197e-01,  6.50820330e-02,
      -3.81488449e-01, -2.94830925e-01, -1.62983836e-01, -2.11720437e-01,
      -4.93386280e-01,  8.65998030e-02, -6.07633617e-03, -1.49535376e-01,
      2.49840735e-02, -1.03801050e-02,  2.47182469e-01, -3.49622110e-01,
      4.70150884e-01,  2.57617235e-01,  1.66718275e-01, -1.12600517e-01,
      1.77388910e-01, -3.23360905e-01,  4.29999536e-01, -5.54800874e-02,
      -4.15236142e-01,  2.93335099e-01, -1.87264589e-01, -3.64413805e-01,
      -2.84468574e-01, -3.71162892e-01, -2.51391012e-01, -1.80520699e-01,
      -5.16928042e-02,  5.60306955e-02,  3.54064975e-01, -3.28893182e-01,
      3.46284230e-01, -1.20814967e-01,  3.94583852e-01, -1.23204708e-01,
      3.38645096e-01,  2.34949453e-01,  1.19678646e-01, -4.98499897e-01,
      -3.81672524e-01, -4.64490772e-01,  4.01044249e-02, -6.08181162e-02,
      4.72310694e-01,  4.79652387e-01, -5.23507828e-05, -3.01607765e-01,
      -3.25350889e-01, -4.34693137e-01,  3.84534886e-01,  2.25914638e-01,
      1.76698074e-01,  2.04250861e-01,  1.01265482e-01,  4.07503864e-01,
      -2.97093336e-01,  1.36806770e-01, -1.33368416e-01,  4.82374173e-01,
      -2.34915039e-01,  2.45125451e-02,  6.75664411e-02, -2.79590751e-01,
      -1.04306446e-01,  1.64592567e-01, -4.76732325e-01, -5.62922434e-02,
      2.62627360e-02,  2.97848627e-01,  3.59625339e-01, -3.68918366e-01,
      4.26498529e-01, -3.32805633e-01, -3.94996536e-01, -2.41990594e-01,
      2.02269208e-03,  1.80161574e-01, -2.85659921e-01,  3.47450227e-01,
      1.16143185e-01, -1.24914033e-01, -4.28519243e-01, -4.56363324e-01,
      -4.15433715e-01, -4.48108561e-01,  4.89443634e-01, -9.46658596e-02,
      5.69519690e-02, -5.00598528e-02, -2.13838399e-01,  4.75866054e-01,
      -1.77283561e-01,  8.57486194e-02,  1.14698038e-01,  3.23988381e-01,
      4.22214720e-01, -4.90415485e-02,  2.36461477e-01,  4.30772274e-01,
      -3.19998122e-01, -1.32497535e-01, -4.16029753e-01,  4.27962391e-01,
      -2.13398596e-01, -3.66360798e-02, -3.82990541e-01, -6.60900804e-02,
      4.49453487e-01,  1.98950576e-01,  2.08715911e-01, -2.25044020e-01,
      -4.36486724e-01, -6.13762539e-03, -1.30444884e-01, -4.69382520e-01,
      -9.53168012e-02, -1.57071754e-01, -1.64010874e-01, -2.85082575e-01,
      4.66323654e-01, -2.45313046e-02, -8.19912310e-02, -3.92068781e-01,
      1.00534350e-01,  3.58489795e-01, -2.97092484e-01, -1.35967145e-01,
      -3.64869035e-01,  1.37834647e-01,  1.93006427e-01, -1.14278003e-01,
      4.65674896e-01,  3.13936300e-01, -1.43094237e-01,  2.64517904e-01,
      4.96220308e-02,  6.23276799e-02, -3.11203941e-01, -2.15575992e-01,
      1.95877679e-01, -1.02357286e-01,  1.32257271e-01, -1.46170456e-01,
      -4.67493768e-01,  3.89554976e-01,  4.73263526e-01,  2.79631814e-01,
      2.98416035e-01,  4.19939686e-01,  3.61802119e-01, -3.73470888e-01,
      1.97790856e-03,  3.95291534e-01,  1.76142017e-01, -9.12744603e-02,
      3.90858172e-01,  4.66473590e-01,  2.87844364e-01,  3.53867799e-01,
      -1.05325159e-01,  1.00741474e-01, -3.40824384e-01,  2.96848100e-01,
      4.54629863e-01, -4.06682391e-02, -3.27385349e-01,  1.38202693e-01,
      -4.89347208e-01,  4.71101653e-01,  2.07940321e-01,  7.30034397e-02,
      2.39576012e-01,  1.05860036e-01, -4.00957932e-01, -1.06963310e-01,
      -4.64682546e-01,  3.61916547e-01,  3.15094513e-01,  1.82302640e-01,
      -2.99137696e-01,  3.64425268e-02, -2.17231978e-01,  2.75745992e-01,
      -1.83701497e-01,  3.00510811e-01, -2.68331127e-01, -6.10813779e-02,
      6.39848139e-02,  4.67913878e-01, -2.73696914e-01,  2.19666897e-01,
      -2.77678241e-01, -3.01003489e-01,  1.99304892e-01, -3.28931453e-01,
      1.60246816e-01,  4.29424313e-01,  2.35554093e-01,  8.26943634e-02,
      2.83047843e-01,  4.95502840e-01,  1.87470940e-01, -2.13107960e-01,
      4.18460476e-01,  4.44451496e-02, -7.27631561e-02,  2.20141801e-01,
      2.25435214e-01,  2.95989221e-02,  7.49345491e-03,  2.65113604e-01,
      -4.23127085e-01, -4.27895756e-01,  2.33517132e-01, -4.71636139e-01,
      6.47345165e-03,  3.03675983e-01, -6.74767852e-02, -3.15085675e-01,
      1.96307825e-01,  3.10428112e-01,  2.63723516e-02,  2.54415977e-01,
      4.68284810e-01,  4.46792841e-01,  2.41289190e-01, -4.45989304e-01,
      -2.38028171e-02, -1.52599715e-01,  3.90226988e-01,  7.83102328e-02,
      -4.16870633e-01,  5.78823864e-02,  1.35090633e-01,  3.97073936e-01,
      -1.56745954e-01, -4.49819713e-01, -3.00724421e-01, -3.28990590e-02,
      3.70326592e-01,  1.64551591e-01, -7.65658587e-03,  1.85081053e-01,
      3.17175370e-01, -4.11526215e-01, -5.96427371e-02,  1.26754989e-01,
      -3.95828421e-01, -1.54102259e-01, -3.40302820e-01,  3.83190482e-01,
      4.70407557e-01, -2.00618542e-02, -4.56908593e-01,  2.19155603e-01,
      6.19211543e-02, -1.35881835e-02, -1.34102276e-01,  2.77097324e-01,
      -2.69910018e-01, -3.95244807e-01,  3.79294037e-02, -4.03517057e-01,
      -3.11067782e-01,  2.69648512e-02,  2.85203846e-01,  2.76836696e-02,
      -1.78937076e-01,  4.88969720e-01, -6.15695055e-02, -1.90663552e-02,
      2.18252482e-01,  3.58073281e-01, -4.97100964e-01, -4.39999216e-01,
      3.99495860e-01,  4.90755128e-01, -4.56693391e-01, -7.60568067e-04,
      -1.13445151e-01,  2.02661983e-01, -3.39768665e-01, -3.68529858e-01,
      -4.28790331e-01, -1.65175575e-01, -1.39942387e-01, -3.58927911e-01,
      -2.66359707e-01,  5.43627029e-02,  1.76778992e-01,  4.89122721e-01,
      -2.94310177e-01, -4.61927999e-01, -3.69189842e-01, -1.56241396e-01,
      9.64596851e-02,  4.63660957e-01, -4.29526608e-02, -1.68608560e-01,
      -2.27240803e-01, -3.80967272e-01,  1.96461194e-01,  9.05720143e-04,
      3.13862641e-01,  1.58788293e-01, -3.77785835e-01, -3.37461107e-01,
      3.91232126e-01,  6.63097419e-02, -3.34407754e-01, -6.45250659e-02,
      3.33314617e-01, -1.48646130e-01,  4.52562968e-01, -2.31567297e-01,
      2.18561641e-01,  4.59271488e-01, -1.25110203e-01, -6.06749110e-02,
      -2.08619262e-01,  1.51699093e-01, -4.80221879e-02,  3.37337344e-01,
      2.29068147e-01,  4.91402413e-01,  2.01151070e-01, -2.76355114e-03,
      -3.65844310e-01, -4.29504250e-01,  1.81028742e-01,  7.40999655e-02,
      -2.77329332e-01,  3.25545321e-01,  4.22969898e-01, -3.71749006e-01,
      8.61947100e-02, -1.81208537e-01,  4.07744557e-01,  3.96694042e-01,
      2.83581736e-01,  3.86495174e-01, -4.48812420e-01, -4.26528998e-01,
      3.20370332e-01, -2.13744495e-01,  4.44967049e-01,  8.27187156e-02,
      -1.01996678e-01,  4.13976946e-02, -1.65648183e-02,  2.32033850e-01,
      -3.27432406e-01, -3.69702280e-01, -2.81686661e-01,  3.80313563e-01,
      1.41112700e-01, -2.42346229e-01,  4.55770777e-01, -3.67246178e-01,
      2.84145663e-01, -4.04269098e-01, -4.40284945e-01,  2.19814696e-01,
      -4.10217028e-01, -2.79792333e-01,  2.22397581e-01, -1.98339188e-01,
      3.16287749e-01,  1.90010184e-01,  2.19643404e-01,  2.40999004e-01,
      1.33248944e-01,  2.64655549e-01,  3.60598770e-01, -1.08703777e-01,
      -2.13433373e-01, -4.90685035e-01, -2.65156193e-01, -1.29980806e-01,
      -2.39262717e-01,  1.59704026e-01, -3.38809256e-01,  9.39625902e-02,
      -2.25333378e-01,  2.27106860e-01, -4.07246864e-01, -1.03332971e-01,
      4.96598616e-01,  2.15625305e-01, -2.99969789e-01, -3.31077572e-01,
      1.94781744e-01,  1.95951264e-01,  4.67127932e-01, -2.30030111e-01,
      3.99587549e-01,  4.53159672e-01, -3.93266647e-01,  1.86510607e-01,
      -1.45124145e-01,  2.67619360e-01, -3.47669236e-02, -1.22655329e-01,
      -2.34557011e-02,  1.98543082e-01,  4.23947421e-01,  1.50872233e-01,
      -1.21319348e-01,  3.02968146e-01, -3.13478496e-01,  1.20845196e-01,
      -1.20493848e-01, -1.79019197e-01, -1.01999993e-01,  2.65466816e-02,
      1.13999571e-02, -4.42024389e-01, -4.93514971e-01,  3.36336145e-01,
      -3.74886746e-01, -5.62440914e-03, -2.59761219e-02, -1.30424901e-01,
      1.90830472e-01, -3.83188748e-03, -4.07142881e-01, -1.71475381e-01,
      -2.53650329e-02,  1.01654465e-01,  5.18946237e-02,  7.78373913e-03,
      2.62498345e-01, -3.29403226e-01,  1.67717641e-01, -1.69679159e-01,
      -2.16944038e-01, -3.99521019e-01, -4.07684309e-01,  2.88393720e-02,
      1.45686031e-01,  4.89971186e-02, -3.24047565e-01, -1.77851684e-01,
      -4.29788646e-01, -2.36492036e-01,  4.22279184e-01, -2.20188417e-01,
      7.11423471e-02, -4.12707014e-01, -4.20703234e-01,  4.35705681e-01,
      -1.47056498e-01, -1.33249279e-01, -1.96189804e-01,  4.29290658e-01,
      4.38217547e-01, -1.62948208e-01, -2.80859665e-01, -2.24295160e-01,
      3.32554401e-01,  2.68793649e-01, -1.03934411e-01,  4.59907804e-02,
      -4.24485759e-01,  1.89611932e-01, -2.09238498e-01,  2.92630930e-01,
      4.00454843e-01,  4.08916250e-01, -4.71060874e-01, -1.73333948e-01,
      3.22732654e-02,  2.13769223e-01,  3.89643189e-01,  4.60813695e-01,
      -4.50130673e-01, -3.31120447e-01,  4.36586747e-01, -3.59642831e-01,
      -1.65732226e-01, -6.26965936e-02,  3.28171045e-01,  1.98967489e-01,
      3.44028346e-01,  3.51787217e-02, -1.28192734e-01, -1.06271524e-01,
      2.19004418e-01, -1.48979802e-01, -3.66180606e-01,  3.03563627e-01,
      3.05531555e-01, -2.25818553e-01, -3.02605522e-01, -2.96856554e-01,
      -1.06279115e-01, -3.46564355e-02,  3.06863927e-01, -9.30014255e-02,
      3.55420092e-01,  3.34259627e-01, -2.16306979e-01,  2.60558907e-01,
      -3.97972628e-01, -1.36613811e-01,  3.12980027e-01, -1.36692266e-01,
      1.81579991e-01, -3.61839241e-01,  1.23012821e-01, -4.22536235e-01,
      2.34620117e-01, -1.54634318e-01, -4.65209522e-01,  1.84854668e-01,
      3.94825965e-01, -2.08655243e-01, -3.01138230e-01,  1.07730496e-01,
      4.21119689e-02, -3.60773099e-01, -4.76900551e-01,  3.50055866e-01,
      -1.36408551e-01,  1.71735724e-01, -3.84445042e-02, -1.39978138e-01,
      -1.13432499e-01,  2.33859230e-01,  2.99584765e-01, -2.29851335e-01,
      3.46470427e-01,  2.97499406e-01,  2.61930507e-01, -3.95098466e-01,
      -4.72073515e-01, -9.41329967e-02, -3.77615127e-01,  3.89718705e-01,
      3.08134761e-01,  1.88363091e-01, -2.87640970e-01, -1.66558432e-01,
      3.60175866e-01, -1.01001181e-01,  8.74139270e-02, -4.38313631e-03,
      3.19509174e-01, -4.65722891e-01,  3.61688579e-01,  2.57433856e-01,
      3.40791311e-01, -4.64985882e-01,  3.39300500e-01, -2.84806451e-01,
      3.01317551e-01, -2.87695772e-01,  1.50300046e-01, -1.90457560e-01,
      -3.03621841e-01,  1.12204630e-02,  3.24957887e-01, -1.31330644e-01,
      -4.26511890e-01, -4.08846887e-01,  9.34189918e-02, -7.97671808e-02,
      1.61982509e-02,  3.07792600e-01,  4.15142100e-01, -2.63338259e-01,
      3.73149210e-01, -5.51669179e-02,  2.44655024e-01,  2.31786309e-01,
      -9.87091006e-02, -1.99091190e-01, -2.41949368e-01,  1.81762239e-01,
      4.47926084e-01, -4.20326072e-01, -1.45026937e-02, -4.95915517e-01,
      1.01701045e-01,  1.02013114e-01, -2.01640711e-02, -2.91610297e-02,
      1.39660044e-01, -3.28460891e-01, -3.22488973e-01,  1.56928815e-01,
      1.58061883e-04,  1.53589784e-01,  1.07756999e-01,  2.04446589e-01,
      1.72223726e-01, -2.62791452e-01,  2.17746419e-02, -3.17947223e-01,
      -1.11984889e-02,  3.53685885e-01,  9.79221275e-02,  3.69254421e-01,
      3.97185137e-01, -4.39433937e-01,  2.56836814e-01, -2.50820933e-01,
      -4.34346349e-01,  2.44012386e-01,  1.89016520e-01, -1.87682899e-01,
      -1.59022982e-01,  2.75998560e-01, -7.13119889e-02,  4.49129406e-01,
      2.46334999e-01,  4.14404551e-01, -2.83688724e-01, -1.91502613e-01,
      -1.15008758e-01, -4.79079945e-01,  1.30649743e-01,  3.53442903e-01,
      -4.65377796e-02,  3.88720278e-01, -2.44915295e-02,  6.46107493e-02,
      2.43105632e-01, -1.97910913e-01, -3.00992049e-01,  2.60870154e-02,
      -3.13042280e-01, -6.31720567e-02,  4.87237252e-01,  9.28326066e-02,
      1.46869984e-01, -1.65106752e-01, -3.01063601e-01, -3.57351060e-02,
      3.16737419e-01,  3.35760665e-01,  4.55537247e-01,  3.86788098e-01,
      2.18395583e-01,  4.13539713e-01, -9.89883998e-02,  4.74181251e-03,
      -3.13675179e-01, -2.60519936e-01,  2.61834655e-01,  2.94380366e-01,
      -3.53239638e-01,  3.17871560e-01,  1.48127265e-01,  7.86024174e-02,
      -4.37896915e-02,  3.26846872e-01,  1.43723528e-02, -1.17345044e-01,
      -4.71990711e-01, -2.49188231e-01, -2.31887827e-01,  3.01563485e-01,
      4.77935978e-01,  3.84005084e-01, -2.76338887e-02, -4.00915421e-02,
      2.56840189e-01,  9.70029339e-02, -1.85376325e-01,  8.02434738e-02,
      4.38874305e-01,  2.08378438e-01, -4.40902630e-01,  3.36130618e-01,
      -1.42777995e-01, -3.16851966e-02,  2.55057515e-01,  1.00694462e-01,
      1.28520885e-01,  1.81641367e-01,  1.00425940e-01, -3.53812776e-01,
      2.99477423e-02,  4.75043104e-01,  2.84442964e-01, -4.16512109e-01,
      1.50635514e-01,  1.78978357e-01,  1.40173028e-01, -2.68474911e-01,
      2.98149769e-01,  1.61828998e-01,  1.92454568e-01, -4.41671876e-01,
      7.73493560e-02, -1.00534257e-01,  1.15224899e-01,  4.90306501e-01,
      1.27537835e-01, -4.98405758e-01,  1.25967431e-01,  2.87681510e-01,
      -3.86182902e-01, -2.48626786e-01, -1.05311684e-01, -2.37906838e-01,
      1.17028447e-01,  1.87962503e-01,  4.99671692e-01, -3.70017393e-01,
      1.77187438e-01, -4.70822962e-01, -2.64512183e-01};

  private double[] signal2EnvelopeExpected = {0.1507223 , 0.23137492, 0.52740817, 0.70730926, 0.62557014,
      0.50029899, 0.58382786, 0.59797418, 0.4289483 , 0.07382973,
      0.32379969, 0.44628833, 0.49889276, 0.58541699, 0.46434446,
      0.20715197, 0.51070876, 0.64274025, 0.4119333 , 0.29755053,
      0.48514568, 0.39811381, 0.1895247 , 0.59300336, 0.53629585,
      0.41816917, 0.59993513, 0.63643331, 0.47866322, 0.39003343,
      0.54738057, 0.49342736, 0.38041359, 0.28341306, 0.09191468,
      0.49604769, 0.48707892, 0.30672392, 0.5769518 , 0.54758004,
      0.35951581, 0.17579734, 0.25569579, 0.5078196 , 0.47985441,
      0.19819233, 0.34650496, 0.26086233, 0.23683753, 0.36981963,
      0.34335964, 0.3908523 , 0.63862565, 0.66843112, 0.34055582,
      0.14788718, 0.24016142, 0.44626419, 0.45430305, 0.24997779,
      0.14549761, 0.26513479, 0.43205845, 0.48445678, 0.25471067,
      0.15864393, 0.38312877, 0.44879   , 0.55174858, 0.35329599,
      0.30169997, 0.49627489, 0.33939988, 0.28517381, 0.37447854,
      0.46106068, 0.39510601, 0.49895699, 0.68925166, 0.46482388,
      0.09378467, 0.44031354, 0.50067894, 0.29624743, 0.21163607,
      0.39773001, 0.43288585, 0.36604338, 0.25186869, 0.21093425,
      0.37269981, 0.43889549, 0.44042281, 0.52764737, 0.34029421,
      0.17403442, 0.36074799, 0.29245556, 0.28310601, 0.3962851 ,
      0.57669944, 0.52980923, 0.33048148, 0.39681311, 0.57029119,
      0.42651432, 0.1726455 , 0.34236253, 0.35334737, 0.2746422 ,
      0.50456969, 0.60676297, 0.17484641, 0.45966764, 0.54591179,
      0.4756334 , 0.58269721, 0.20289478, 0.45303825, 0.61107094,
      0.4866699 , 0.4995385 , 0.11048186, 0.38157579, 0.11656642,
      0.50495396, 0.30759532, 0.46729538, 0.63754374, 0.50951345,
      0.60893065, 0.50218945, 0.42630816, 0.36675996, 0.43799264,
      0.66039672, 0.59896564, 0.36110838, 0.35465058, 0.35912247,
      0.43673414, 0.18151914, 0.51135432, 0.60467994, 0.37538675,
      0.05717907, 0.24594314, 0.70450011, 0.87007226, 0.46970745,
      0.44934704, 0.48992454, 0.20628384, 0.20364135, 0.36782638,
      0.24936364, 0.03339107, 0.13502688, 0.34768489, 0.5033882 ,
      0.27489136, 0.35183241, 0.50833186, 0.26728843, 0.58152471,
      0.54852921, 0.35662192, 0.52425533, 0.59479993, 0.39747218,
      0.4605204 , 0.31397107, 0.20588298, 0.2963903 , 0.16815568,
      0.50703573, 0.37724764, 0.23392298, 0.36653022, 0.14920464,
      0.46430999, 0.47066093, 0.04555524, 0.41909853, 0.41261275,
      0.43616035, 0.41484266, 0.40180046, 0.36489752, 0.14521892,
      0.52767148, 0.32191784, 0.32456515, 0.49815902, 0.39202524,
      0.39142826, 0.50151244, 0.57938808, 0.30389222, 0.37321893,
      0.76985779, 0.44960254, 0.26970119, 0.42030189, 0.22602   ,
      0.37634316, 0.41402705, 0.49948857, 0.57743239, 0.27982576,
      0.32344389, 0.4843262 , 0.14119779, 0.58539577, 0.46229287,
      0.19812966, 0.64664887, 0.78167864, 0.46627835, 0.12326178,
      0.48670329, 0.32891885, 0.16348866, 0.21261131, 0.52355073,
      0.53188854, 0.13017028, 0.37905948, 0.04048804, 0.41273344,
      0.29899107, 0.46258374, 0.57759352, 0.28199717, 0.28812896,
      0.11529366, 0.24372602, 0.32336233, 0.46438673, 0.64476997,
      0.448413  , 0.29336367, 0.49738454, 0.36485383, 0.29424364,
      0.40835326, 0.30094322, 0.42571454, 0.20212164, 0.51826218,
      0.38676668, 0.38534267, 0.39160194, 0.14822486, 0.41389614,
      0.16215887, 0.41278494, 0.38617224, 0.40941926, 0.64581007,
      0.40180115, 0.51877877, 0.51527857, 0.25540516, 0.70595774,
      0.60217535, 0.31680472, 0.40254445, 0.33767598, 0.56470887,
      0.77324194, 0.29059237, 0.35681854, 0.3267383 , 0.31297613,
      0.5921328 , 0.30066295, 0.149836  , 0.20892463, 0.49251797,
      0.4379924 , 0.13926971, 0.28763154, 0.31256737, 0.22792078,
      0.25139003, 0.49157956, 0.41644135, 0.09634779, 0.44694194,
      0.60570416, 0.36952577, 0.42876097, 0.69695537, 0.42853695,
      0.24968121, 0.40415861, 0.26680615, 0.32413044, 0.38177823,
      0.36959986, 0.34063429, 0.50725349, 0.47040876, 0.42692969,
      0.80054996, 0.66888361, 0.19510909, 0.38435823, 0.19180325,
      0.61370583, 0.4813548 , 0.17782915, 0.30590848, 0.23596871,
      0.39812226, 0.44061141, 0.23350725, 0.36123068, 0.68588142,
      0.43019548, 0.23500405, 0.48420656, 0.44549455, 0.39695334,
      0.08767006, 0.40309973, 0.63162592, 0.45105084, 0.22035109,
      0.40332718, 0.47378839, 0.43704152, 0.18035164, 0.33673612,
      0.49010306, 0.20783635, 0.21220107, 0.17371964, 0.55476867,
      0.54760773, 0.24672829, 0.08922655, 0.3947179 , 0.64588506,
      0.42703991, 0.30017843, 0.1516963 , 0.47617487, 0.54982832,
      0.20615585, 0.31790588, 0.62977652, 0.44426923, 0.17290819,
      0.27373845, 0.11211687, 0.14035806, 0.33806856, 0.44420902,
      0.26163303, 0.11814102, 0.26177999, 0.23741101, 0.73698245,
      0.81425308, 0.49945814, 0.2943325 , 0.32393902, 0.42240114,
      0.5188103 , 0.43999042, 0.50842872, 0.40036185, 0.19225874,
      0.1117726 , 0.59161215, 0.52280635, 0.28886671, 0.59630989,
      0.17488731, 0.32065916, 0.34827833, 0.40816944, 0.49349247,
      0.6070023 , 0.35240651, 0.25087551, 0.52887184, 0.61358999,
      0.33990639, 0.08375264, 0.25145384, 0.5214604 , 0.41949401,
      0.13823487, 0.53996343, 0.57543824, 0.33088416, 0.38020336,
      0.32046505, 0.03926169, 0.24205732, 0.28410158, 0.19069093,
      0.30832928, 0.38478158, 0.3145735 , 0.18756254, 0.46942767,
      0.42871878, 0.30899903, 0.59344599, 0.63531993, 0.21698221,
      0.42098108, 0.48378147, 0.4932041 , 0.28318555, 0.1789709 ,
      0.29877604, 0.49598806, 0.57971967, 0.23620683, 0.41853845,
      0.3378469 , 0.07301168, 0.22644213, 0.33213662, 0.23788234,
      0.10953195, 0.3911612 , 0.7476258 , 0.57940319, 0.26098567,
      0.47520535, 0.45664209, 0.30376894, 0.2526215 , 0.38099685,
      0.44852723, 0.31042835, 0.02900172, 0.36898605, 0.47140591,
      0.48808534, 0.73528552, 0.53122536, 0.04513213, 0.15375461,
      0.41430333, 0.62649699, 0.41689688, 0.14412677, 0.15827974,
      0.47060102, 0.60420309, 0.46224793, 0.34327551, 0.37901068,
      0.39207652, 0.27538975, 0.06556258, 0.18700666, 0.51098271,
      0.59559446, 0.27539487, 0.42496062, 0.40321398, 0.15568026,
      0.46425434, 0.558723  , 0.52228286, 0.56684091, 0.45869416,
      0.28158404, 0.22897108, 0.15930233, 0.13647963, 0.30023306,
      0.61547338, 0.42470914, 0.08725491, 0.42834116, 0.45440009,
      0.33675124, 0.32879645, 0.25981684, 0.36186845, 0.48969005,
      0.30300854, 0.08564573, 0.22614864, 0.56872497, 0.71631896,
      0.58265536, 0.57525959, 0.74117465, 0.58337748, 0.05696769,
      0.1725496 , 0.26318366, 0.63184391, 0.36923713, 0.43251244,
      0.31651616, 0.18182476, 0.37561948, 0.40118078, 0.37728897,
      0.28723597, 0.51356668, 0.67880988, 0.47260536, 0.39190141,
      0.49876813, 0.35102569, 0.48329319, 0.45089581, 0.20326627,
      0.31756516, 0.60807882, 0.29753229, 0.22894184, 0.32875396,
      0.29036738, 0.46812611, 0.62999797, 0.45294005, 0.20897661,
      0.33563773, 0.55741559, 0.33338078, 0.2606035 , 0.4628365 ,
      0.28347555, 0.56830977, 0.54655862, 0.21156672, 0.10075488,
      0.27491154, 0.23075714, 0.16956955, 0.42723769, 0.22910855,
      0.49141517, 0.54409761, 0.2982185 , 0.56463072, 0.55210254,
      0.28417557, 0.1110854 , 0.28763663, 0.624491  , 0.64452281,
      0.3735239 , 0.1212807 , 0.2725522 , 0.54965434, 0.42479827,
      0.30450503, 0.61150959, 0.79197628, 0.60354503, 0.32039592,
      0.21858242, 0.47566502, 0.46545691, 0.10427624, 0.15769575,
      0.01786293, 0.35923302, 0.53125964, 0.37434858, 0.39247873,
      0.54210668, 0.5142501 , 0.35945086, 0.51233255, 0.42192443,
      0.28424954, 0.70874708, 0.60154125, 0.21984451, 0.45615763,
      0.57384645, 0.2642536 , 0.26844374, 0.49163523, 0.20010674,
      0.25747035, 0.27840297, 0.13784334, 0.27526424, 0.50609957,
      0.59086124, 0.36394639, 0.56564638, 0.38515174, 0.18466382,
      0.40290362, 0.19047719, 0.34953492, 0.1343216 , 0.24693144,
      0.24106722, 0.4445198 , 0.67352106, 0.51352652, 0.34559479,
      0.41381449, 0.51550301, 0.37082125, 0.31700098, 0.47803603,
      0.27859468, 0.62008179, 0.78775078, 0.4028144 , 0.18651081,
      0.14892382, 0.27319981, 0.29147184, 0.12765658, 0.11660359,
      0.27177184, 0.42929221, 0.48807454, 0.12794989, 0.42133534,
      0.44101815, 0.12149957, 0.4157445 , 0.1820321 , 0.14226308,
      0.04040168, 0.34565347, 0.56475335, 0.61197267, 0.35122835,
      0.46104673, 0.35153593, 0.21905366, 0.26046671, 0.19971847,
      0.25329037, 0.44541904, 0.35979135, 0.05649829, 0.23680826,
      0.20170742, 0.20507075, 0.43599294, 0.34261664, 0.17077359,
      0.37671131, 0.25194274, 0.4273931 , 0.4968272 , 0.31852241,
      0.15233426, 0.22187314, 0.35978876, 0.18919256, 0.43283868,
      0.67847509, 0.42613174, 0.25457253, 0.1082712 , 0.50068987,
      0.79192645, 0.49050748, 0.18763792, 0.22871845, 0.40668405,
      0.66307115, 0.53496944, 0.31330381, 0.2810648 , 0.42480243,
      0.51362446, 0.36277249, 0.10400598, 0.18306191, 0.45283801,
      0.33202478, 0.23457501, 0.57530611, 0.40058994, 0.5222339 ,
      0.64351509, 0.48477095, 0.10377347, 0.43184725, 0.39209508,
      0.54586433, 0.83469925, 0.7043227 , 0.48623554, 0.3831498 ,
      0.21827575, 0.40470788, 0.35911641, 0.21240943, 0.38003758,
      0.27712007, 0.23158707, 0.16750059, 0.2349242 , 0.33585795,
      0.40128848, 0.48185561, 0.51424539, 0.35062133, 0.33345006,
      0.36732234, 0.18254839, 0.39532618, 0.30975323, 0.11544849,
      0.44240954, 0.50474662, 0.25625316, 0.26882793, 0.59079592,
      0.55598445, 0.39385925, 0.14857802, 0.34060888, 0.36211992,
      0.14374836, 0.42276138, 0.33793407, 0.4463513 , 0.54736063,
      0.4661735 , 0.42177537, 0.43644933, 0.35506244, 0.16068629,
      0.16678176, 0.43665542, 0.67619327, 0.46849322, 0.14840059,
      0.32450952, 0.21471733, 0.25862523, 0.1760191 , 0.5302715 ,
      0.41883039, 0.29362801, 0.39352685, 0.3082644 , 0.51064507,
      0.61091065, 0.50076434, 0.18035097, 0.48505343, 0.71982652,
      0.3707773 , 0.19252028, 0.48780294, 0.63014904, 0.38858812,
      0.16398775, 0.14378571, 0.33961734, 0.48206474, 0.50434324,
      0.45109592, 0.26696072, 0.60468079, 0.4649909 , 0.33931008,
      0.30431214, 0.30236826, 0.3794853 , 0.20309903, 0.41051402,
      0.35938452, 0.25656357, 0.32742101, 0.4227492 , 0.43463164,
      0.53442857, 0.35383641, 0.15887235, 0.35057281, 0.4689844 ,
      0.47980541, 0.26367943, 0.4132305 , 0.19207997, 0.32754595,
      0.41386862, 0.23908983, 0.2356437 , 0.28036894, 0.42007878,
      0.5895671 , 0.50254375, 0.01654572, 0.49695056, 0.5135277 ,
      0.16785916, 0.10033878, 0.03046884, 0.13967623, 0.44632927,
      0.57144175, 0.2517447 , 0.19054322, 0.21106652, 0.13809193,
      0.21701979, 0.29258069, 0.27617789, 0.09566064, 0.31820218,
      0.5714758 , 0.36945331, 0.13296469, 0.40445744, 0.60547264,
      0.49030653, 0.32260402, 0.59316285, 0.6427458 , 0.33619421,
      0.18901652, 0.29110194, 0.50489077, 0.27711325, 0.28215741,
      0.47084909, 0.24982065, 0.53184921, 0.54270748, 0.2108876 ,
      0.19494027, 0.51445718, 0.623248  , 0.35840014, 0.13981548,
      0.39106632, 0.23228223, 0.15335568, 0.31992602, 0.37159479,
      0.32624912, 0.08924463, 0.3136016 , 0.60007318, 0.50914093,
      0.14816468, 0.15208796, 0.26834303, 0.38880048, 0.43864298,
      0.52848607, 0.36064609, 0.48751147, 0.46295217, 0.21841532,
      0.56303808, 0.35213466, 0.23724371, 0.36789753, 0.35763748,
      0.44422618, 0.45789873, 0.35743477, 0.40232502, 0.22603421,
      0.13071581, 0.04942552, 0.32889551, 0.36976629, 0.29134486,
      0.48640028, 0.37995576, 0.42681103, 0.66634274, 0.4805767 ,
      0.40917198, 0.32137824, 0.17071131, 0.2576621 , 0.223177  ,
      0.19290459, 0.31528929, 0.43934738, 0.53162127, 0.44353034,
      0.40628157, 0.40022992, 0.39300768, 0.27959585, 0.11825532,
      0.20415538, 0.18925813, 0.46589041, 0.35674857, 0.26010852,
      0.52152872, 0.7034711 , 0.41726371, 0.19434539, 0.17927079,
      0.38803319, 0.27883244, 0.30577033, 0.20327271, 0.47206383,
      0.47280859, 0.1797923 , 0.13308285, 0.29958102, 0.50264789,
      0.64129555, 0.5275681 , 0.30709051, 0.50326924, 0.55465839,
      0.2858528 , 0.14289407, 0.33067876, 0.18752415, 0.30137266,
      0.64274645, 0.48242337, 0.19173417, 0.63233764, 0.48774422};
}
